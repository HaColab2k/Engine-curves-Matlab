disp('Input Pk');
Pk = input('Pk=');
disp('Input Pa');
Pa= input('Pa=');
disp('Input Tk');
Tk=input('Tk=');
disp('Input landa1');
landa1= input('landa1=');
disp('Input landa2');
landa2= input('landa2=');
disp('Input landaT');
landaT= input('landaT=');
disp('Input Tr');
Tr=input('Tr=');
disp('Input Pr');
Pr=input('Pr=');
disp('Input anpha');
anpha= input('anpha=');
disp('Input landa');
landa=input('landa=');
disp('Input phid');
phid=input('phid=');
a=(1/16)*(Tk/(Tk+30))*0.9;
b=(17*landa1-landaT*landa2*((Pr/Pa)^(2/3)));
c=a*b;
disp('1.Intake factor ηv:');
disp(c);
yr=(landa2/(16*c))*(Pr/Pk)*(Tk/Tr);
disp('2.Residual gas coefficient γr:');
disp(yr);
Ta=(Tk+30+landaT*yr*Tr*(Pa/Pr)^(1/3))/(1+yr);
disp('3.nhiet do cuoi qua trinh nap:');
disp(Ta);
av=(19.806+yr*(19.867+(1.634/anpha)))/(1+yr);
bv1=0.00419/2;
bv2=yr*(1/2)*((427.38+(184.36/anpha))/100000);
bv=((bv1+bv2)/(1+yr))*2;
syms n
kq= vpasolve((n-1)*(av+((bv/2)*Ta*(17^(n-1)+1)))-8.314);
n1 = double(kq);
disp('4. chi so nen da bien trung binh n1:');
disp(n1);
Pc=Pa*(17^n1);
disp(' 5.ap suat qua trinh nen Pc:');
disp(Pc);
Tc=Ta*(17^(n1-1));
disp(' 6.nhiet do Tc:');
disp(Tc);
M0=(1/0.21)*((0.870/12)+(0.126/4)-(0.004/32));
M1=anpha*M0;
M2=(0.004/32)+(0.126/4)+M1;
B0=M2/M1;
B=1+((B0-1)/(1+yr));
Xz=0.8/0.95;
Bz=1+((B0-1)/(1+yr))*Xz;
e=M2*(Xz+(yr/B0));
d=M1*(1-Xz);
avv=(e*av+d*19.806)/(e+d);
bvv=(2*((e*bv/2)+d*0.00419/2))/(e+d);
q=0.8*42530/(M1*(1+yr));
w=(av+(bv*Tc/2)+8.314*landa)*Tc;
u=(Bz*bvv/2);
r=(Bz*(avv+8.314));
o=-(q+w);
dt = (r ^ 2) - 4 * u * o;
if dt < 0
 disp(' Phuong trình vô nghiem');
elseif dt == 0
disp(' Phuong trình có 1 nghiem');
x = -r / (2 * u);
disp(x);
else
 x1= (-r - sqrt(dt)) / (2 * u);
 x2=(-r + sqrt(dt)) / (2 * u);
end
if x1>0
    Tz = x1;
 disp('7.nhiet do Tz');
 disp(Tz);
else
 Tz = x2;
 disp('8.nhiet do Tz');
 disp(Tz);
end
Pz=landa*Pc;
disp('ap suat Pz');
disp(Pz);
pro=(Bz/landa)*(Tz/Tc);
denta=21/pro;
disp('nhap he so n2');
n2=input('n2=');
Tb=Tz/(denta^(n2-1));
disp('9.nhiet do cua Tb');
disp(Tb);
Pb=Pz/(denta^n2);
disp('10.ap suat cua Pb');
disp(Pb);
Tr2=Tb*((Pr/Pb)^(1/3));
phantram=((Tr-Tr2)/Tr);
disp('11.phan tram sai so dentaTr:');
disp(phantram);
Pi1= (Pa*((21^n1)/20));
Pi2=landa*(pro-1);
Pi3= (landa*pro/(n2-1));
Pi4= 1-1/(denta^(n2-1));
Pi5= (1/(n1-1))*(1-(1/21^(n1-1)));
Pi=Pi1*(Pi2+Pi3*Pi4-Pi5);
Pii=phid*Pi;
disp('12.ap suat chi thi trung binh Pi');
disp(Pii);
Pm =0.013+0.0156*(0.095*3800/30)+(Pr-Pa);
disp('13.ap suat ton that co khi Pm');
disp(Pm);
Pe=Pi-Pm;
disp('14.ap suat co ich trung binh Pe');
disp(Pe);
Km=Pe/Pi;
Ki=8.314*(M1*Pi*Tk/(42530*Pk*c));
Ke=8.314*(M1*Pe*Tk/(42530*c*Pk));
Gi=3600/(42530*Ki);
Gii=432*(Pk*c/(M1*Pi*Tk));
Ge=3600/(42530*Ke);
Gee=432*(Pk*c/(M1*Pe*Tk));
disp('15.hieu suat co goi Km');
disp(Km);
disp('16.hieu suat chi thi Ki');
disp(Ki);
disp('17.hieu suat co ich Ke');
disp(Ke);
disp('18.suat tieu hao nhien lieu chi thi Gi');
disp(Gi);
disp('19.suat tieu hao nhien lieu thuc te Gii');
disp(Gii);
disp('20.suat tieu hao nhien lieu co ich Ge');
disp(Ge);
disp('21.suat tieu hao nhien lieu co ich thuc te Gee');
disp(Gee);